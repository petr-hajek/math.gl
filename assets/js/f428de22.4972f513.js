"use strict";(self.webpackChunkproject_website=self.webpackChunkproject_website||[]).push([[2258],{562:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>s,default:()=>h,frontMatter:()=>o,metadata:()=>c,toc:()=>a});var r=i(4848),t=i(8453);const o={},s="Homogeneous Coordinates",c={id:"developer-guide/math/homogeneous-coordinates",title:"Homogeneous Coordinates",description:"This article is a work in progress.",source:"@site/../docs/developer-guide/math/homogeneous-coordinates.md",sourceDirName:"developer-guide/math",slug:"/developer-guide/math/homogeneous-coordinates",permalink:"/math.gl/docs/developer-guide/math/homogeneous-coordinates",draft:!1,unlisted:!1,editUrl:"https://github.com/visgl/math.gl/tree/master/docs/../docs/developer-guide/math/homogeneous-coordinates.md",tags:[],version:"current",frontMatter:{},sidebar:"defaultSidebar",previous:{title:"View and Projection Matrices",permalink:"/math.gl/docs/developer-guide/math/view-and-projection"},next:{title:"3D Coordinate Systems",permalink:"/math.gl/docs/developer-guide/math/coordinate-systems"}},d={},a=[{value:"The W Coordinate",id:"the-w-coordinate",level:3},{value:"Practical Usage",id:"practical-usage",level:2},{value:"Projective Transformation",id:"projective-transformation",level:3},{value:"Translation of 3D coordinates",id:"translation-of-3d-coordinates",level:3},{value:"Perspective Transformation",id:"perspective-transformation",level:3},{value:"Background Information",id:"background-information",level:2}];function l(e){const n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"homogeneous-coordinates",children:"Homogeneous Coordinates"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"This article is a work in progress."}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["The math.gl ",(0,r.jsx)(n.code,{children:"Vector4"})," class is not normally used to represent four dimensonal points. Instead it is intended to be used to calculate with 3 dimensonal ",(0,r.jsx)(n.strong,{children:"homogeneous coordinates"}),", as defined by projective geometry."]}),"\n",(0,r.jsxs)(n.p,{children:["Mathematically, in projective geometry, each ",(0,r.jsx)(n.code,{children:"Vector4"}),' is interpreted as a point on a 3D line through the origin. And it is this line that is the primary object, in the sense that the point is only considered to be one of infinintely many "representatives" of that a line through the origin. Dividing ',(0,r.jsx)(n.code,{children:"xyz"})," with the same number will generate another point, or 'representative' of the same line"]}),"\n",(0,r.jsx)(n.p,{children:"The main reason homogeneous coordinates and projective geometry are used in 3D graphics programming is that they allow perspective projection and translations to be represented as linear transformations using 4x4 matrices."}),"\n",(0,r.jsx)(n.h3,{id:"the-w-coordinate",children:"The W Coordinate"}),"\n",(0,r.jsxs)(n.p,{children:["Mathematically, homogeneous coordinates add one extra dimension to represent a number. In the 3 dimensional computer graphics case, it is customary to refer to the extra (4th) components as ",(0,r.jsx)(n.code,{children:"w"}),". Mathematically, the ",(0,r.jsx)(n.code,{children:"w"})," coordinate indicates which representative along the projective line."]}),"\n",(0,r.jsxs)(n.p,{children:["There is a straightforward graphical interpretation of the ",(0,r.jsx)(n.code,{children:"w"})," coordinate: During projection of a set of homogeneous vectors onto a plane at distance 1 from the origin, all the vectors are normalized so that their ",(0,r.jsx)(n.code,{children:"w"})," coordinates are ",(0,r.jsx)(n.code,{children:"1"})," by dividing ",(0,r.jsx)(n.code,{children:"xyz"})," with ",(0,r.jsx)(n.code,{children:"w"}),". which leads to the following graphical interpretation:"]}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:(0,r.jsx)(n.code,{children:"w"})}),(0,r.jsx)(n.th,{children:"Graphical Interpretation"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:["> ",(0,r.jsx)(n.code,{children:"1"})]}),(0,r.jsx)(n.td,{children:"your object will look smaller"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:["< ",(0,r.jsx)(n.code,{children:"1"})]}),(0,r.jsx)(n.td,{children:"your object will look bigger"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:["= ",(0,r.jsx)(n.code,{children:"0"})]}),(0,r.jsx)(n.td,{children:"will cause a crash or undefined behavior"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:["< ",(0,r.jsx)(n.code,{children:"0"})]}),(0,r.jsx)(n.td,{children:"will flip your object (upside-down, back-to-front, ...)"})]})]})]}),"\n",(0,r.jsxs)(n.p,{children:["Both math.gl and typical GPUs do not support calculations on homogeneous coordinates with a ",(0,r.jsx)(n.code,{children:"w"})," component of zero. (However, zero ",(0,r.jsx)(n.code,{children:"w"}),'coordinates play a very important role in general projective geometry, see "Background" below).']}),"\n",(0,r.jsx)(n.h2,{id:"practical-usage",children:"Practical Usage"}),"\n",(0,r.jsx)(n.h3,{id:"projective-transformation",children:"Projective Transformation"}),"\n",(0,r.jsx)(n.p,{children:"A general projective transformation matrix has the following format"}),"\n",(0,r.jsx)("math",{display:"block",children:(0,r.jsxs)("mrow",{children:[(0,r.jsx)("mfenced",{open:"[",close:"]",children:(0,r.jsxs)("mtable",{children:[(0,r.jsxs)("mtr",{children:[(0,r.jsx)("mtd",{columnalign:"center",children:(0,r.jsxs)("msub",{children:[(0,r.jsx)("mi",{children:"c"}),(0,r.jsx)("mn",{children:"0"})]})}),(0,r.jsx)("mtd",{columnalign:"center",children:(0,r.jsxs)("msub",{children:[(0,r.jsx)("mi",{children:"c"}),(0,r.jsx)("mn",{children:"1"})]})}),(0,r.jsx)("mtd",{columnalign:"center",children:(0,r.jsxs)("msub",{children:[(0,r.jsx)("mi",{children:"c"}),(0,r.jsx)("mn",{children:"2"})]})}),(0,r.jsx)("mtd",{columnalign:"center",children:(0,r.jsxs)("msub",{children:[(0,r.jsx)("mi",{children:"proj"}),(0,r.jsx)("mi",{children:"x"})]})})]}),(0,r.jsxs)("mtr",{children:[(0,r.jsx)("mtd",{columnalign:"center",children:(0,r.jsxs)("msub",{children:[(0,r.jsx)("mi",{children:"c"}),(0,r.jsx)("mn",{children:"1"})]})}),(0,r.jsx)("mtd",{columnalign:"center",children:(0,r.jsxs)("msub",{children:[(0,r.jsx)("mi",{children:"c"}),(0,r.jsx)("mn",{children:"2"})]})}),(0,r.jsx)("mtd",{columnalign:"center",children:(0,r.jsxs)("msub",{children:[(0,r.jsx)("mi",{children:"c"}),(0,r.jsx)("mn",{children:"3"})]})}),(0,r.jsx)("mtd",{columnalign:"center",children:(0,r.jsxs)("msub",{children:[(0,r.jsx)("mi",{children:"proj"}),(0,r.jsx)("mi",{children:"y"})]})})]}),(0,r.jsxs)("mtr",{children:[(0,r.jsx)("mtd",{columnalign:"center",children:(0,r.jsxs)("msub",{children:[(0,r.jsx)("mi",{children:"c"}),(0,r.jsx)("mn",{children:"2"})]})}),(0,r.jsx)("mtd",{columnalign:"center",children:(0,r.jsxs)("msub",{children:[(0,r.jsx)("mi",{children:"c"}),(0,r.jsx)("mn",{children:"3"})]})}),(0,r.jsx)("mtd",{columnalign:"center",children:(0,r.jsxs)("msub",{children:[(0,r.jsx)("mi",{children:"c"}),(0,r.jsx)("mn",{children:"4"})]})}),(0,r.jsx)("mtd",{columnalign:"center",children:(0,r.jsxs)("msub",{children:[(0,r.jsx)("mi",{children:"proj"}),(0,r.jsx)("mi",{children:"z"})]})})]}),(0,r.jsxs)("mtr",{children:[(0,r.jsx)("mtd",{columnalign:"center",children:(0,r.jsxs)("msub",{children:[(0,r.jsx)("mi",{children:"trans"}),(0,r.jsx)("mi",{children:"x"})]})}),(0,r.jsx)("mtd",{columnalign:"center",children:(0,r.jsxs)("msub",{children:[(0,r.jsx)("mi",{children:"trans"}),(0,r.jsx)("mi",{children:"y"})]})}),(0,r.jsx)("mtd",{columnalign:"center",children:(0,r.jsxs)("msub",{children:[(0,r.jsx)("mi",{children:"trans"}),(0,r.jsx)("mi",{children:"z"})]})}),(0,r.jsx)("mtd",{columnalign:"center",children:(0,r.jsxs)("msub",{children:[(0,r.jsx)("mi",{children:"scale"}),(0,r.jsx)("mi",{children:"global"})]})})]})]})}),(0,r.jsx)("mo",{children:"."}),(0,r.jsx)("mfenced",{open:"[",close:"]",children:(0,r.jsxs)("mtable",{children:[(0,r.jsx)("mtr",{children:(0,r.jsx)("mtd",{columnalign:"center",children:(0,r.jsx)("mi",{children:"x"})})}),(0,r.jsx)("mtr",{children:(0,r.jsx)("mtd",{columnalign:"center",children:(0,r.jsx)("mi",{children:"y"})})}),(0,r.jsx)("mtr",{children:(0,r.jsx)("mtd",{columnalign:"center",children:(0,r.jsx)("mi",{children:"z"})})}),(0,r.jsx)("mtr",{children:(0,r.jsx)("mtd",{columnalign:"center",children:(0,r.jsx)("mi",{children:"w"})})})]})})]})}),"\n",(0,r.jsx)(n.h3,{id:"translation-of-3d-coordinates",children:"Translation of 3D coordinates"}),"\n",(0,r.jsx)(n.p,{children:"Linear transformations on a vector space can not move the origin, they can only scale and rotate."}),"\n",(0,r.jsxs)(n.p,{children:["Translations leave the ",(0,r.jsx)(n.code,{children:"w"})," coordinate unchanged."]}),"\n",(0,r.jsxs)(n.p,{children:["As can be seen in the general format of the projection matrix, setting ",(0,r.jsx)(n.code,{children:"w"})," to 0 prevents a vector from picking up the translations when multiplied with a 4x4 matrix. (easy to see as the translations are stored in the final column of the transposed matrix)"]}),"\n",(0,r.jsx)(n.h3,{id:"perspective-transformation",children:"Perspective Transformation"}),"\n",(0,r.jsxs)(n.p,{children:["Note that in general, a perspective transformation (i.e. multipliying) do change the ",(0,r.jsx)(n.code,{children:"w"})," coordinate of the ",(0,r.jsx)(n.code,{children:"Vector4"}),', so vectors must be "scaled" after transformation when used in JavaScript.']}),"\n",(0,r.jsxs)(n.p,{children:["GPU Note: the GPU automatically divides ",(0,r.jsx)(n.code,{children:"vec4"})," ",(0,r.jsx)(n.code,{children:"xyz"})," components with ",(0,r.jsx)(n.code,{children:"w"})," when they are returned from the vertex shader (when homogeneous coordinates are returned from the vertex shader (typically by assigning a ",(0,r.jsx)(n.code,{children:"vec4"})," to ",(0,r.jsx)(n.code,{children:"gl_Position"}),"). This can be an important detail to be aware of when comparing JavaScript and GLSL code, and also when working in screen space (post-projection) in the vertex shader, in which case you typically do need to perform the ",(0,r.jsx)(n.code,{children:"w"})," scaling yourself."]}),"\n",(0,r.jsx)(n.h2,{id:"background-information",children:"Background Information"}),"\n",(0,r.jsx)(n.p,{children:"Some fun facts to provide additional context around homogeneous coordinates."}),"\n",(0,r.jsx)(n.p,{children:'Projective geometry was coordinatized (in the form or homogeneous coordinates) in the early 1800s by Pl\xfccker and M\xf6bius, almost 200 years after the coordinatization of "affine" geometry by Descartes.'}),"\n",(0,r.jsxs)(n.p,{children:["There is a special ",(0,r.jsx)(n.strong,{children:"notation"})," for homogeneous coordinate vectors that emphasizes the relative aspect of the values:"]}),"\n",(0,r.jsx)("math",{children:(0,r.jsxs)("mfenced",{open:"[",close:"]",separators:":::",children:[(0,r.jsx)("mi",{children:"x"}),(0,r.jsx)("mi",{children:"y"}),(0,r.jsx)("mi",{children:"z"})]})}),"\n",(0,r.jsxs)(n.p,{children:["However, in mathematics, one of the most important aspects of projective geometry is that it can be used to avoid handling of ",(0,r.jsx)(n.strong,{children:"special cases"}),' (this aspect is not used in math.gl). Essentially, in contrast to line equations in affine geometry, projective geometry allows parallel lines to be represented by adding a set of additional points in the form of a "plane at infinity" (which is represented by ',(0,r.jsx)(n.code,{children:"w"}),"=",(0,r.jsx)(n.code,{children:"0"}),"). This is powerful as it makes it possible to e.g. make statements about geometry (such as two lines always meet in one point) without having to make tedious exceptions for parallel lines."]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>s,x:()=>c});var r=i(6540);const t={},o=r.createContext(t);function s(e){const n=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:s(e.components),r.createElement(o.Provider,{value:n},e.children)}}}]);